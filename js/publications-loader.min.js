document.addEventListener("DOMContentLoaded",async function(){await loadPublications(),setupSearch()});let allPublications=[];async function loadPublications(){const t=document.getElementById("publications-container"),n=document.getElementById("publication-highlights");if(t)try{const t=await fetch("data/publications.json");if(allPublications=await t.json(),n){renderHighlights(allPublications.filter(t=>!0===t.highlighted))}renderPublications(allPublications)}catch(n){console.error("Error loading publications:",n),t.innerHTML="<p>Error loading publications. Please check back later.</p>"}}function renderHighlights(t){const n=document.getElementById("publication-highlights");if(!n||0===t.length)return;t.sort((t,n)=>parseInt(n.year)-parseInt(t.year));const e=t.map(t=>`\n        <div class="publication-item" style="display: flex; gap: 1.5rem; margin-bottom: 0.5rem; align-items: start;">\n            ${t.image?`\n                <div class="publication-image" style="flex: 0 0 200px;">\n                    <img src="${t.image}" alt="${t.title}" style="width: 100%; height: auto; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">\n                </div>\n            `:""}\n            <div class="publication-content" style="flex: 1;">\n                <h3 style="margin-top: 0; font-size: 1.1rem;">${t.title}</h3>\n                <p class="publication-authors" style="font-style: italic; margin-bottom: 0.3rem; font-size: 0.9rem;">${t.authors}</p>\n                <p class="publication-venue" style="font-weight: 500; margin-bottom: 0.3rem; font-size: 0.9rem;">${t.venue}, ${t.year}</p>\n                \n                <div class="publication-links" style="margin-top: 0.75rem;">\n                    ${t.links?t.links.map(t=>`<a href="${t.url}" target="_blank" class="btn-link" style="display: inline-block; margin-right: 10px; padding: 4px 8px; background: var(--bg-light); border: 1px solid var(--border-color); border-radius: 4px; text-decoration: none; font-size: 0.85rem;">${t.name}</a>`).join(""):""}\n                </div>\n            </div>\n        </div>\n    `).join("");n.innerHTML=e}function renderPublications(t){const n=document.getElementById("publications-container");if(!n)return;if(0===t.length)return void(n.innerHTML="<p>No publications found.</p>");t.sort((t,n)=>parseInt(n.year)-parseInt(t.year));const e={};t.forEach(t=>{e[t.year]||(e[t.year]=[]),e[t.year].push(t)});let i="";Object.keys(e).sort((t,n)=>n-t).forEach(t=>{i+=`<h2 class="year-heading" style="color: var(--primary-color); margin: 2rem 0 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">${t}</h2>`,i+=e[t].map((t,n)=>`\n            <div class="publication-item" style="display: flex; gap: 1.5rem; margin-bottom: 0.5rem; align-items: start;">\n                ${t.image?`\n                    <div class="publication-image" style="flex: 0 0 200px;">\n                        <img src="${t.image}" alt="${t.title}" style="width: 100%; height: auto; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">\n                    </div>\n                `:""}\n                <div class="publication-content" style="flex: 1;">\n                    <h3 style="margin-top: 0;">${t.title}</h3>\n                    <p class="publication-authors" style="font-style: italic; margin-bottom: 0.5rem;">${t.authors}</p>\n                    <p class="publication-venue" style="font-weight: bold; margin-bottom: 0.5rem;">${t.venue}</p>\n                    ${t.abstract?`<p class="publication-abstract" style="margin-top: 1rem;">${t.abstract}</p>`:""}\n                    \n                    <div class="publication-links" style="margin-top: 1rem;">\n                        ${t.links?t.links.map(t=>`<a href="${t.url}" target="_blank" class="btn-link" style="display: inline-block; margin-right: 10px; padding: 4px 8px; background: var(--bg-light); border: 1px solid var(--border-color); border-radius: 4px; text-decoration: none; font-size: 0.9rem;">${t.name}</a>`).join(""):""}\n                        ${t.bibtex?'<button class="btn-bibtex" onclick="toggleBibtex(this)" style="background: none; border: 1px solid var(--border-color); padding: 0.4rem 0.8rem; border-radius: 4px; cursor: pointer; font-size: 0.85rem; color: var(--text-color);">BibTeX</button>':""}\n                    </div>\n                    \n                    ${t.bibtex?`\n                        <div class="bibtex-container" style="display: none; margin-top: 1rem; background: var(--bg-light); padding: 1rem; border-radius: 4px; overflow-x: auto;">\n                            <pre style="margin: 0; font-size: 0.85rem;"><code>${t.bibtex}</code></pre>\n                        </div>\n                    `:""}\n                </div>\n            </div>\n        `).join("")}),n.innerHTML=i}function setupSearch(){const t=document.getElementById("pub-filter");t&&t.addEventListener("input",t=>{const n=t.target.value.toLowerCase();renderPublications(allPublications.filter(t=>t.title.toLowerCase().includes(n)||t.authors.toLowerCase().includes(n)||t.venue.toLowerCase().includes(n)))})}window.toggleBibtex=function(t){const n=t.parentElement.nextElementSibling;if(n&&n.classList.contains("bibtex-container")){const e="none"===n.style.display;n.style.display=e?"block":"none",t.style.backgroundColor=e?"var(--bg-light)":"transparent"}};