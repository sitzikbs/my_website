const HTML_ENTITIES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};function escapeHtml(t){return"string"!=typeof t?"":t.replace(/[&<>"'\/]/g,t=>HTML_ENTITIES[t])}function sanitizeUrl(t){if("string"!=typeof t)return"";const e=t.trim().toLowerCase();return e.startsWith("javascript:")||e.startsWith("data:")||e.startsWith("vbscript:")||e.startsWith("file:")?(console.warn("Blocked potentially dangerous URL:",t),""):e.startsWith("http://")||e.startsWith("https://")||e.startsWith("mailto:")||e.startsWith("/")||e.startsWith("./")||e.startsWith("../")?t:e.includes(":")?(console.warn("Blocked unknown protocol in URL:",t),""):t}function validateData(t,e=[]){if(!t||"object"!=typeof t)return!1;for(const a of e)if(!(a in t))return console.warn(`Missing required field: ${a}`),!1;return!0}async function safeFetch(t,e=1e4){const a=new AbortController,r=setTimeout(()=>a.abort(),e);try{const e=await fetch(t,{signal:a.signal,headers:{Accept:"application/json"}});if(clearTimeout(r),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(t){if(clearTimeout(r),"AbortError"===t.name)throw new Error("Request timeout");throw t}}"undefined"!=typeof module&&module.exports?module.exports={escapeHtml:escapeHtml,sanitizeUrl:sanitizeUrl,validateData:validateData,safeFetch:safeFetch}:window.SecurityUtils={escapeHtml:escapeHtml,sanitizeUrl:sanitizeUrl,validateData:validateData,safeFetch:safeFetch};